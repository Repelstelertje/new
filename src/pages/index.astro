---
import Base from "../layouts/Base.astro";
import ProfileCard from "../components/ProfileCard.astro";
import { getPopular, type Profile } from "../lib/api";
import { buildTitle, buildDescription, ORG_JSONLD, WEBSITE_JSONLD } from "../lib/seo";

const stagingEnv = import.meta.env.STAGING;
const staging = stagingEnv === true || stagingEnv === "true";

const title = buildTitle("home");
const description = buildDescription("home");

let popularProfiles: Profile[] = [];

try {
  popularProfiles = await getPopular(12);
} catch (error) {
  console.error("[home] Fout bij ophalen populaire profielen", error);
}
---
<Base
  title={title}
  description={description}
  path="/"
  staging={staging}
  jsonLd={[ORG_JSONLD, WEBSITE_JSONLD]}
  og={{ image: "/og/default.jpg" }}
>
  <section class="flex flex-col gap-6 rounded-2xl bg-white p-8 shadow-sm">
    <div class="flex flex-col gap-4">
      <h1 class="text-3xl font-semibold text-neutral-900 sm:text-4xl">Vind nu je volgende chatpartner in Nederland</h1>
      <p class="text-lg text-neutral-600">
        OproepjesNederland brengt volwassenen bij elkaar voor een veilige en snelle chatervaring. Kies je provincie,
        ontdek echte profielen en ga direct het gesprek aan.
      </p>
    </div>
    <div class="flex flex-wrap items-center gap-4">
      <a
        href="/dating-nederland/"
        class="inline-flex items-center justify-center rounded-full bg-accent px-6 py-3 text-base font-semibold text-white shadow transition hover:bg-accent/90"
      >
        Start chat — 18+
      </a>
      <p class="text-sm text-neutral-500">Gratis aanmelden, anoniem chatten en alleen voor 18+ bezoekers.</p>
    </div>
  </section>

  <section class="grid gap-6 rounded-2xl bg-white p-8 shadow-sm">
    <h2 class="text-2xl font-semibold text-neutral-900">Waarom kiezen voor OproepjesNederland?</h2>
    <ul class="grid gap-4 text-neutral-600 sm:grid-cols-2">
      <li class="rounded-xl border border-neutral-200 p-4">
        <h3 class="text-lg font-semibold text-neutral-900">Provincie-overzicht</h3>
        <p>Blader snel door alle provincies en ga direct door naar profielen die openstaan voor een nieuw gesprek.</p>
      </li>
      <li class="rounded-xl border border-neutral-200 p-4">
        <h3 class="text-lg font-semibold text-neutral-900">Echte chats</h3>
        <p>Onze links brengen je meteen naar de echte chatomgeving waar je 18+ matches ontmoet.</p>
      </li>
      <li class="rounded-xl border border-neutral-200 p-4">
        <h3 class="text-lg font-semibold text-neutral-900">Veilige omgeving</h3>
        <p>Geen spam of afleiding: je bepaalt zelf met wie je een gesprek begint.</p>
      </li>
      <li class="rounded-xl border border-neutral-200 p-4">
        <h3 class="text-lg font-semibold text-neutral-900">Mobielvriendelijk</h3>
        <p>Start je chat vanaf je telefoon of desktop met een intuïtieve ervaring.</p>
      </li>
    </ul>
  </section>

  <section id="popular" class="grid gap-6 rounded-2xl bg-white p-8 shadow-sm">
    <div class="flex flex-col gap-2 sm:flex-row sm:items-end sm:justify-between">
      <div>
        <h2 class="text-2xl font-semibold text-neutral-900">Populaire profielen</h2>
        <p class="text-neutral-600">Deze leden zijn nu actief en klaar voor een nieuw gesprek.</p>
      </div>
      <a
        href="/dating-nederland/"
        class="inline-flex items-center justify-center rounded-full border border-accent px-4 py-2 text-sm font-semibold text-accent transition hover:bg-accent/10"
      >
        Bekijk alle provincies
      </a>
    </div>

    {popularProfiles.length > 0 ? (
      <div class="grid grid-cols-1 gap-6 sm:grid-cols-2 xl:grid-cols-3">
        {popularProfiles.map((profile, index) => (
          <ProfileCard {...profile} key={profile.id} rank={index + 1} />
        ))}
      </div>
    ) : (
      <p class="rounded-xl border border-dashed border-neutral-200 bg-neutral-50 p-6 text-center text-neutral-500">
        Momenteel zijn er geen populaire profielen beschikbaar. Probeer het later opnieuw.
      </p>
    )}
  </section>
</Base>
